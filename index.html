<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wegovy價格換算</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Microsoft JhengHei', sans-serif;
        }
        
        /* 手機優化樣式 */
        input[type="number"] {
            font-size: 16px; /* 防止iOS縮放 */
            -webkit-appearance: none;
            -moz-appearance: textfield;
        }
        
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        select {
            font-size: 16px; /* 防止iOS縮放 */
        }
        
        /* 觸控優化 */
        button {
            touch-action: manipulation;
        }
        
        /* 改善對比度 */
        .input-light {
            background-color: rgba(255, 255, 255, 0.95);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .input-light:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="max-w-sm mx-auto bg-white min-h-screen shadow-lg">
        <!-- 固定標題區 -->
        <div class="sticky top-0 bg-white z-10 px-4 py-4 border-b border-gray-200">
            <h1 class="text-xl font-bold text-center mb-1 text-gray-800">Wegovy價格換算</h1>
            <p class="text-center text-gray-600 text-sm">計算PAP回饋後，每盒1mg的平均價格</p>
        </div>
        
        <!-- 滾動內容區 -->
        <div class="px-4 py-4 pb-20">

            <!-- 1.0mg 方框 -->
            <div class="mb-4 p-4 rounded-xl shadow-sm" style="background-color: #b8e1dc;">
                <h2 class="text-lg font-bold mb-3 text-gray-800 text-center">1.0mg</h2>
                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">購買盒數</label>
                        <input type="number" id="A1" min="0" inputmode="numeric" class="w-full px-4 py-3 input-light rounded-lg focus:outline-none text-lg" placeholder="0">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">每盒金額 (NT$)</label>
                        <input type="number" id="A2" min="0" step="0.01" inputmode="decimal" class="w-full px-4 py-3 input-light rounded-lg focus:outline-none text-lg" placeholder="0.00">
                    </div>
                </div>
            </div>

            <!-- 1.7mg 方框 -->
            <div class="mb-4 p-4 rounded-xl shadow-sm" style="background-color: #0192c1;">
                <h2 class="text-lg font-bold mb-3 text-white text-center">1.7mg</h2>
                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium text-white mb-2">購買盒數</label>
                        <input type="number" id="B1" min="0" inputmode="numeric" class="w-full px-4 py-3 input-light rounded-lg focus:outline-none text-lg" placeholder="0">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-white mb-2">每盒金額 (NT$)</label>
                        <input type="number" id="B2" min="0" step="0.01" inputmode="decimal" class="w-full px-4 py-3 input-light rounded-lg focus:outline-none text-lg" placeholder="0.00">
                    </div>
                </div>
            </div>

            <!-- 2.4mg 方框 -->
            <div class="mb-4 p-4 rounded-xl shadow-sm" style="background-color: #57656e;">
                <h2 class="text-lg font-bold mb-3 text-white text-center">2.4mg</h2>
                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium text-white mb-2">購買盒數</label>
                        <input type="number" id="C1" min="0" inputmode="numeric" class="w-full px-4 py-3 input-light rounded-lg focus:outline-none text-lg" placeholder="0">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-white mb-2">每盒金額 (NT$)</label>
                        <input type="number" id="C2" min="0" step="0.01" inputmode="decimal" class="w-full px-4 py-3 input-light rounded-lg focus:outline-none text-lg" placeholder="0.00">
                    </div>
                </div>
            </div>

            <!-- 贈送藥品數量方框 -->
            <div class="mb-6 p-4 rounded-xl shadow-sm" style="background-color: #57656e;">
                <h2 class="text-lg font-bold mb-2 text-white text-center">🎁 贈送藥品數量</h2>
                <div class="bg-black bg-opacity-20 rounded-lg p-3 mb-4">
                    <p class="text-xs text-white leading-relaxed">贈送會以劑量計算，來平均每1mg價格。總回饋盒數最多為3盒</p>
                </div>
                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium text-white mb-2">選擇贈送劑量</label>
                        <select id="dosageSelect" class="w-full px-4 py-3 input-light rounded-lg focus:outline-none text-lg">
                            <option value="1">1.0mg</option>
                            <option value="1.7">1.7mg</option>
                            <option value="2.4">2.4mg</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-white mb-2">贈送盒數 (自動計算)</label>
                        <div class="w-full px-4 py-3 bg-gray-200 rounded-lg text-lg text-gray-600 text-center font-bold">
                            <span id="E1Display">0</span> 盒
                        </div>
                        <input type="hidden" id="E1" value="0">
                    </div>
                </div>
            </div>

            <!-- 計算按鈕 -->
            <button onclick="calculatePrice()" class="w-full py-4 rounded-xl text-white font-bold text-lg mb-6 shadow-lg active:scale-95 transition-transform" style="background-color: #ee82ee;">
                🧮 計算平均價格
            </button>

            <!-- 結果顯示區域 -->
            <div id="result" class="text-center mb-6"></div>
        </div>
        
        <!-- 固定底部安全區 -->
        <div class="h-20"></div>
    </div>

    <script>
        // 監聽輸入變化，自動更新贈送盒數
        document.addEventListener('input', function(e) {
            if (e.target.id === 'A1' || e.target.id === 'B1' || e.target.id === 'C1') {
                updateGiftBoxes();
            }
        });

        function updateGiftBoxes() {
            const A1 = parseInt(document.getElementById('A1').value) || 0;
            const B1 = parseInt(document.getElementById('B1').value) || 0;
            const C1 = parseInt(document.getElementById('C1').value) || 0;
            const total = A1 + B1 + C1;
            
            let E1 = 0;
            if (total < 3) {
                E1 = 0;
            } else if (total === 3 || total === 4 || total === 5) {
                E1 = 1;
            } else if (total >= 6) {
                E1 = 3;
            }
            
            document.getElementById('E1').value = E1;
            document.getElementById('E1Display').textContent = E1;
            
            // 更新總盒數顯示
            updateTotalBoxes(total);
        }
        
        function updateTotalBoxes(total) {
            // 可以在這裡添加總盒數的視覺反饋
            const resultDiv = document.getElementById('result');
            if (total > 0 && total < 3) {
                resultDiv.innerHTML = '<div class="bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded-lg text-sm">💡 購買 ' + total + ' 盒，還需要 ' + (3 - total) + ' 盒才能獲得贈品</div>';
            } else if (total >= 3) {
                resultDiv.innerHTML = '<div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg text-sm">✅ 購買 ' + total + ' 盒，符合贈品條件！</div>';
            } else {
                resultDiv.innerHTML = '';
            }
        }

        function calculatePrice() {
            const A1 = parseInt(document.getElementById('A1').value) || 0;
            const A2 = parseFloat(document.getElementById('A2').value) || 0;
            const B1 = parseInt(document.getElementById('B1').value) || 0;
            const B2 = parseFloat(document.getElementById('B2').value) || 0;
            const C1 = parseInt(document.getElementById('C1').value) || 0;
            const C2 = parseFloat(document.getElementById('C2').value) || 0;
            const selectedDosage = parseFloat(document.getElementById('dosageSelect').value);
            const E1 = parseInt(document.getElementById('E1').value) || 0;
            
            const totalBoxes = A1 + B1 + C1;
            const resultDiv = document.getElementById('result');
            
            if (totalBoxes < 3) {
                resultDiv.innerHTML = `
                    <div class="bg-red-50 border-2 border-red-200 rounded-xl p-4 mb-4">
                        <div class="text-red-600 text-lg font-bold mb-2">❌ 無法計算</div>
                        <p class="text-red-600 text-sm">購買總盒數須為3盒以上才能享有PAP回饋</p>
                    </div>
                `;
                return;
            }
            
            // 計算總成本
            const totalCost = (A1 * A2) + (B1 * B2) + (C1 * C2);
            
            // 計算總劑量 (包含購買的和贈送的)
            const purchasedDosage = (A1 * 1.0) + (B1 * 1.7) + (C1 * 2.4);
            const giftDosage = selectedDosage * E1;
            const totalDosage = purchasedDosage + giftDosage;
            
            // 計算每1mg平均價格
            const avgPrice = totalCost / totalDosage;
            
            resultDiv.innerHTML = `
                <div class="bg-gradient-to-r from-purple-100 to-pink-100 border-2 border-purple-200 rounded-xl p-6 mb-4 shadow-lg">
                    <div class="text-center">
                        <div class="text-gray-600 text-sm mb-2">💰 每1mg平均價格</div>
                        <div class="text-4xl font-bold text-purple-800 mb-2">NT$ ${avgPrice.toFixed(2)}</div>
                        <div class="text-xs text-gray-500 bg-white bg-opacity-50 rounded-lg px-3 py-2">
                            總成本: NT$ ${totalCost.toFixed(2)} ÷ 總劑量: ${totalDosage.toFixed(1)}mg
                        </div>
                    </div>
                </div>
                <div class="bg-green-50 border border-green-200 rounded-lg p-3 text-xs text-green-700">
                    ✅ 已包含 ${E1} 盒 ${selectedDosage}mg 贈品 (${(selectedDosage * E1).toFixed(1)}mg)
                </div>
            `;
        }

        // 初始化贈送盒數
        updateGiftBoxes();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'970627deb2ee5700',t:'MTc1NTQwMjA4Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
